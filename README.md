# Modelling and Implementation of the RV32I ISA in Idris2

This repository contains the source code of the case study used in the paper _A Quantitative Type Approach to Formal
Component-Based System Design_ (accepted by the _Forum on Specification and Design Languages 2024/FDL2024_). 
In this case study, we *manually* modelled the RV32I ISA in Idris2, which is then transformed and implemented.

## How This Repository is Organised

### Repository Structure

The folder structure of this repository is shown as follows.

```bash
.
├── src           # The source code of the Idris2 model of RV32I ISA 
│   ├── c         # The C-implementation of components (operations on BitVectors and memory)
│   └── idris     # The top-level model in Idris2 that models the ISA by composing C-components
├── test          # Unit tests of the RV32I model (tested with gcc-12.2.0 with arch rv32i and abi ilp32)
│   ├── env       # Linking script
│   └── src       # Assembly code
└── pynq-testbed  # Partial implementation of the ISA on the PYNQ platform
```
Assembly codes for unit testing (in `test/src`) are adapted from test cases generated by [riscv-tests](https://github.com/riscv-software-src/riscv-tests) (Copyright (c) 2012-2015, The Regents of the University of California (Regents)).

### Tags and Commits

This repository utilises _tags_ and _commits_ on the *main* branch to demonstrate the results after each step of the case study.
Specifically:
 * Tag `v1.1` archives model implemented with the `IO` monad.
 * Tag `v1.3` archives model implemented with linearity.
 * Commits archive transformations applied on the model.

